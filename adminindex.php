<!--

=========================================================
* khetbajaar Dashboard - v1.1.2
=========================================================

* Product Page: https://www.creative-tim.com/product/khetbajaar-dashboard
* Copyright 2020 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://github.com/creativetimofficial/khetbajaar-dashboard/blob/master/LICENSE.md)

* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. -->
<!DOCTYPE html>
<html lang="en">

    <head>
<style>
        table {
            border-collapse: collapse;
            width: 100%;
            border: 1px solid #ddd;
        }

        th, td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: #f2f2f2;
        }
    </style>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>
            Khet Bajaar Dashboard - Free Dashboard for Bootstrap 4 by Creative Tim
        </title>
        <!-- Favicon -->
        <link href="./assets/img/brand/favicon.png" rel="icon" type="image/png">
        <!-- Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
        <!-- Icons -->
        <link href="./assets/js/plugins/nucleo/css/nucleo.css" rel="stylesheet" />
        <link href="./assets/js/plugins/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet" />
        <!-- CSS Files -->
        <link href="./assets/css/khetbajaar_dashboard.css?v=1.1.2" rel="stylesheet" />
    </head>

    <body class="">
        <nav class="navbar navbar-vertical fixed-left navbar-expand-md navbar-light bg-white" id="sidenav-main">
            <div class="container-fluid">
                <!-- Toggler -->
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#sidenav-collapse-main" aria-controls="sidenav-main" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <!-- Brand -->
                <a class="navbar-brand pt-0" href="./adminindex.php">
                    <img src="LOGO.png" class="navbar-brand-img" alt="..." width="100%" height="100%">
                </a>
                <!-- User -->
                <ul class="nav align-items-center d-md-none">
                    <li class="nav-item dropdown">
                        <a class="nav-link nav-link-icon" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="ni ni-bell-55"></i>
                        </a>
                        <div class="dropdown-menu dropdown-menu-arrow dropdown-menu-right" aria-labelledby="navbar-default_dropdown_1">
                            <a class="dropdown-item" href="#">Action</a>
                            <a class="dropdown-item" href="#">Another action</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#">Something else here</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <div class="media align-items-center">
                                <span class="avatar avatar-sm rounded-circle">
                                    <img alt="Image placeholder" src="./assets/img/theme/team-1-800x800.jpg
                                         ">
                                </span>
                            </div>
                        </a>
                        <div class="dropdown-menu dropdown-menu-arrow dropdown-menu-right">
                            <div class=" dropdown-header noti-title">
                                <h6 class="text-overflow m-0">Welcome!</h6>
                            </div>
                            <a href="./examples/profile.html" class="dropdown-item">
                                <i class="ni ni-single-02"></i>
                                <span>My profile</span>
                            </a>
                            <a href="./examples/profile.html" class="dropdown-item">
                                <i class="ni ni-settings-gear-65"></i>
                                <span>Settings</span>
                            </a>
                            <a href="./examples/profile.html" class="dropdown-item">
                                <i class="ni ni-calendar-grid-58"></i>
                                <span>Activity</span>
                            </a>
                            <a href="./examples/profile.html" class="dropdown-item">
                                <i class="ni ni-support-16"></i>
                                <span>Support</span>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="#!" class="dropdown-item">
                                <i class="ni ni-user-run"></i>
                                <span>Logout</span>
                            </a>
                        </div>
                    </li>
                </ul>
                <!-- Collapse -->
                <div class="collapse navbar-collapse" id="sidenav-collapse-main">
                    <!-- Collapse header -->
                    <div class="navbar-collapse-header d-md-none">
                        <div class="row">
                            <div class="col-6 collapse-brand">
                                <a href="./index.html">
                                    <img src="./assets/img/brand/blue.png">
                                </a>
                            </div>
                            <div class="col-6 collapse-close">
                                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#sidenav-collapse-main" aria-controls="sidenav-main" aria-expanded="false" aria-label="Toggle sidenav">
                                    <span></span>
                                    <span></span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- Form -->
                    <form class="mt-4 mb-3 d-md-none">
                        <div class="input-group input-group-rounded input-group-merge">
                            <input ty
                                   </form>
                            <!-- Navigation -->
                            <ul class="navbar-nav"pe="search" class="form-control form-control-rounded form-control-prepended" placeholder="Search" aria-label="Search">
                                <div class="input-group-prepend">
                                    <div class="input-group-text">
                                        <span class="fa fa-search"></span>
                                    </div>
                                </div>
                        </div>
                    </form>
                    <!-- Navigation -->
                    <ul class="navbar-nav">
                        <li class="nav-item  active ">
                            <a class="nav-link  active " href="./index.html">
                                <i class="ni ni-tv-2 text-primary"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link " href="./examples/icons.html">
                                <i class="ni ni-planet text-blue"></i> Icons
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link " href="./examples/maps.html">
                                <i class="ni ni-pin-3 text-orange"></i> Maps
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link " href="./examples/profile.html">
                                <i class="ni ni-single-02 text-yellow"></i> User profile
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link " href="./examples/tables.html">
                                <i class="ni ni-bullet-list-67 text-red"></i> Tables
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./examples/login.html">
                                <i class="ni ni-key-25 text-info"></i> Login
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./examples/register.html">
                                <i class="ni ni-circle-08 text-pink"></i> Register
                            </a>
                        </li>
                    </ul>
                    <!-- Divider -->
                    <hr class="my-3">
                    <!-- Heading -->
                    <h6 class="navbar-heading text-muted">Documentation</h6>
                    <!-- Navigation -->
                    <ul class="navbar-nav mb-md-3">
                        <li class="nav-item">
                            <a class="nav-link" href="https://demos.creative-tim.com/khetbajaar-dashboard/docs/getting-started/overview.html">
                                <i class="ni ni-spaceship"></i> Getting started
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://demos.creative-tim.com/khetbajaar-dashboard/docs/foundation/colors.html">
                                <i class="ni ni-palette"></i> Foundation
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://demos.creative-tim.com/khetbajaar-dashboard/docs/components/alerts.html">
                                <i class="ni ni-ui-04"></i> Components
                            </a>
                        </li>
                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item active active-pro">
                            <a class="nav-link" href="./examples/upgrade.php">
                                <i class="ni ni-send text-dark"></i> Upgrade to PRO
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="main-content">

            <!-- Navbar -->
            <nav class="navbar navbar-top navbar-expand-md navbar-dark" id="navbar-main">
                <div class="container-fluid">
                    <!-- Brand -->
                    <a class="h4 mb-0 text-white text-uppercase d-none d-lg-inline-block" href="./adminindex.php">Dashboard</a>
                    <!-- Form -->
                    <form class="navbar-search navbar-search-dark form-inline mr-3 d-none d-md-flex ml-lg-auto">
                        <div class="form-group mb-0">
                            <div class="input-group input-group-alternative">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-search"></i></span>
                                </div>
                                <input class="form-control" placeholder="Search" type="text">
                            </div>
                        </div>
                    </form>
                    <!-- User -->
                    <ul class="navbar-nav align-items-center d-none d-md-flex">
                        <li class="nav-item dropdown">
                            <a class="nav-link pr-0" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="media align-items-center">

                                    <div class="media-body ml-2 d-none d-lg-block">
                                        <?php
                                        if (isset($_SESSION['aid'])) {
                                            echo "<b> Welcome" . " " . $row['admin_email'] . "</b> ";
                                            echo "<a href='logout.php'><i class='fa fa-user'></i>Logout</a>";
                                        } else {
                                            echo "<a href='Login.php'><i class='fa fa-user'></i> Login</a>";
                                        }
                                        ?>
                                    </div>
                                </div>
                            </a>
                            <div class="dropdown-menu dropdown-menu-arrow dropdown-menu-right">
                                <div class=" dropdown-header noti-title">
                                    <h6 class="text-overflow m-0">Welcome!</h6>
                                </div>
                                <a href="./examples/profile.html" class="dropdown-item">
                                    <i class="ni ni-single-02"></i>
                                    <span>My profile</span>
                                </a>
                                <a href="./examples/profile.html" class="dropdown-item">
                                    <i class="ni ni-settings-gear-65"></i>
                                    <span>Settings</span>
                                </a>
                                <a href="./examples/profile.html" class="dropdown-item">
                                    <i class="ni ni-calendar-grid-58"></i>
                                    <span>Activity</span>
                                </a>
                                <a href="./examples/profile.html" class="dropdown-item">
                                    <i class="ni ni-support-16"></i>
                                    <span>Support</span>
                                </a>
                                <div class="dropdown-divider"></div>
                                <a href="#!" class="dropdown-item">
                                    <i class="ni ni-user-run"></i>
                                    <span>Logout</span>
                                </a>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
            <!-- End Navbar -->
            <!-- Header -->
<div class="header bg-gradient-primary pb-8 pt-5 pt-md-8">
    <div class="container-fluid">
        <div class="header-body">
            <!-- Card stats -->
            <div class="row">
                <div class="col-md-6 col-lg-3">
                    <div class="card bg-primary shadow border-0">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col">
                                    <h5 class="text-uppercase text-white mb-0">Total Farmers</h5>
                                    <?php
                                    $conn = mysqli_connect("localhost", "root", "", "project");

                                    // Check the connection
                                    if (!$conn) {
                                        die("Connection failed: " . mysqli_connect_error());
                                    }

                                    // Count the number of farmers in the database
                                    $sql = "SELECT COUNT(*) as count FROM farmer_registration";
                                    $result = mysqli_query($conn, $sql);
                                    $row = mysqli_fetch_assoc($result);
                                    $totalFarmers = $row['count'];

                                    echo '<span class="h2 font-weight-bold text-white">' . $totalFarmers . '</span>';

                                    // Close the connection
                                    mysqli_close($conn);
                                    ?>
                                </div>
                                <div class="col-auto">
                                    <div class="icon icon-shape bg-warning text-white rounded-circle shadow">
                                        <i class="fas fa-chart-pie"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6 col-lg-3">
                    <div class="card bg-info shadow border-0">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col">
                                    <h5 class="text-uppercase text-white mb-0">Total Companies</h5>
                                    <?php
                                    $conn = mysqli_connect("localhost", "root", "", "project");

                                    // Check the connection
                                    if (!$conn) {
                                        die("Connection failed: " . mysqli_connect_error());
                                    }

                                    // Count the number of companies in the database
                                    $sql = "SELECT COUNT(*) as count FROM company_registration";
                                    $result = mysqli_query($conn, $sql);
                                    $row = mysqli_fetch_assoc($result);
                                    $totalCompanies = $row['count'];

                                    echo '<span class="h2 font-weight-bold text-white">' . $totalCompanies . '</span>';

                                    // Close the connection
                                    mysqli_close($conn);
                                    ?>
                                </div>
                                <div class="col-auto">
                                    <div class="icon icon-shape bg-warning text-white rounded-circle shadow">
                                        <i class="fas fa-percent"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>







            <div class="col">

                <div class="card shadow">
                    <div class="card-header bg-transparent">
                        <div class="row align-items-center">
                            <div class="col">

                                <h2 class="mb-0">Total Farmers</h2>
                                <?php
                                $conn = mysqli_connect("localhost", "root", "", "project");

// Check the connection
                                if (!$conn) {
                                    die("Connection failed: " . mysqli_connect_error());
                                }

// Select the display_name column from the users table
                                $sql = "SELECT first_name,last_name FROM farmer_registration";

                                $result = mysqli_query($conn, $sql);

// Output the display names
                                if (mysqli_num_rows($result) > 0) {
                                    while ($row = mysqli_fetch_assoc($result)) {
                                        echo "<b>" . $row["first_name"] . " " . $row["last_name"] . "</b>" . "<br>";
                                    }
                                } else {
                                    echo "No results found";
                                }

// Close the connection
                                mysqli_close($conn);
                                ?>

                            </div>
                            <div class="col-sm-6">

                                <h2 class="mb-0">Total Companies</h2>
                                <?php
                                $conn = mysqli_connect("localhost", "root", "", "project");

// Check the connection
                                if (!$conn) {
                                    die("Connection failed: " . mysqli_connect_error());
                                }

// Select the display_name column from the users table
                                $sql = "SELECT company_name FROM company_registration";

                                $result = mysqli_query($conn, $sql);

// Output the display names
                                if (mysqli_num_rows($result) > 0) {
                                    while ($row = mysqli_fetch_assoc($result)) {
                                        echo "<b>" . $row["company_name"] . "</b>" . "<br>";
                                    }
                                } else {
                                    echo "No results found";
                                }

// Close the connection
                                mysqli_close($conn);
                                ?>
                            </div>
                        </div>
                    </div>


    <?php
    /*
    // Replace with your database connection code
     $conn = mysqli_connect("localhost", "root", "", "project");

// Check the connection
                                if (!$conn) {
                                    die("Connection failed: " . mysqli_connect_error());
                                }

    $sql4 = "SELECT CONCAT(farmer_registration.first_name, ' ', farmer_registration.last_name) AS farmer_name, crop_information.crop_name, crop_information.crop_quantity, crop_information.imgpath
            FROM farmer_registration 
            JOIN crop_information  ON farmer_registration = crop_information.farmer_id";

    $resulttt = $conn->query($sql4);

    if ($resulttt->num_rows > 0) {
        while ($rowy = $result->fetch_assoc()) {
            echo "<tr>";
            echo "<td>" . $rowy["farmer_name"] . "</td>";
            echo "<td>" . $rowy["crop_name"] . "</td>";
            echo "<td>" . $rowy["crop_quantity"] . "</td>";
            echo "<td><img src='" . $rowy["imgpath"] . "' alt='Crop Image' width='100'></td>";
            echo "</tr>";
        }
    } else {
        echo "<tr><td colspan='4'>No records found.</td></tr>";
    }

    $conn->close();
    */?>


                    <div class="card-header bg-transparent">
                        <div class="row align-items-center">

                        </div>

                    </div>
                    <form action="" method="POST">
                        <label>Crop Name:</label><input type="text" name="crop"> <br>
                        <label>From Date:</label><input type="date" name="fromdate"> 
                        <label>To Date:</label><input type="date" name="todate"> <br>
                        <input type="submit" name="submit" value="search">
                    </form>
                    <?php
$crop = @$_POST['crop'];
$fromdate = @$_POST['fromdate'];
$todate = @$_POST['todate'];
$conn = mysqli_connect("localhost", "root", "", "project");

// Check the connection
if (isset($_POST['submit'])) {
    if (!$conn) {
        die("Connection failed: " . mysqli_connect_error());
    }

    // Select the necessary columns from the crop_information table
    $sql = "SELECT ci.crop_name, ci.crop_quantity, ci.date, ci.crop_price, fr.first_name, fr.last_name 
            FROM crop_information ci
            JOIN farmer_registration fr ON ci.farmer_id = fr.farmer_id
            WHERE ci.date BETWEEN '$fromdate' AND '$todate' 
            AND ci.crop_name = '" . mysqli_real_escape_string($conn, $crop) . "'";

    $result = mysqli_query($conn, $sql);

    // Output the results in tabular format
    echo '<table border="1px" style="width:80%;">';
    echo '<tr><th>Name</th><th>Crop Name</th><th>Quantity</th><th>Validity Date</th><th>Price</th><th>Send</th></tr>';

    if (mysqli_num_rows($result) > 0) {
        while ($row = mysqli_fetch_assoc($result)) {
            echo '<tr>';
            echo "<td>" . $row['first_name'] . " " . $row['last_name'] . "</td>";
            echo "<td>" . $row['crop_name'] . "</td>";
            echo "<td>" . $row['crop_quantity'] . "</td>";
            echo "<td>" . $row['date'] . "</td>";
            echo "<td>" . $row['crop_price'] . "</td>";
            echo"<td>" ."<button type='button' class='btn btn-primary' data-bs-toggle='modal' data-bs-target='#exampleModal'>Send</button>"."</td>";
            echo '</tr>';
        }
    } else {
        echo "<tr><td colspan='5'>No results found</td></tr>";
    }
    echo '</table>';

    // Close the connection
    mysqli_close($conn);
}
?>
                    
                    <div class="card-body">

                        <!-- Chart -->
                        <div class="chart">
                            <canvas id="chart-orders" class="chart-canvas"></canvas>
                        </div>

                    </div>
                </div>

            </div>

        </div>


    </div>
</div>

</div>
</div>
<!--   Core   -->
<script src="./assets/js/plugins/jquery/dist/jquery.min.js"></script>
<script src="./assets/js/plugins/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<!--   Optional JS   -->
<script src="./assets/js/plugins/chart.js/dist/Chart.min.js"></script>
<script src="./assets/js/plugins/chart.js/dist/Chart.extension.js"></script>
<!--   khetbajaar JS   -->
<script src="./assets/js/khetbajaar-dashboard.min.js?v=1.1.2"></script>
<script src="https://cdn.trackjs.com/agent/v3/latest/t.js"></script>
<script>
    window.TrackJS &&
            TrackJS.install({
                token: "ee6fab19c5a04ac1a32a645abde4613a",
                application: "khetbajaar-dashboard-free"
            });
</script>


<!--Model Class-->


<!-- Modal -->
<!-- Bootstrap CSS and JavaScript (ensure you include these dependencies) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>

<!-- Your PHP logic here -->
<?php
// Your PHP code for fetching data from the database goes here
?>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Send Message</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="sendMessageForm">
                    <div class="input-group">
                        <span class="input-group-text">Message</span>
                        <textarea class="form-control" name="message" aria-label="With textarea"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="sendMessage()">Send message</button>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript for sending the message -->
<script>
    function sendMessage() {
        // Get the message from the textarea
        var message = $("textarea[name='message']").val();

        // Get the farmer ID from the button data attribute
        var farmerId = $("#exampleModal .btn-primary").data("farmer-id");

        // Send the message using AJAX to your PHP script
        $.ajax({
            type: "POST",
            url: "your_orders.php", // Replace with your PHP script for sending messages
            data: { farmerId: farmerId, message: message },
            success: function (response) {
                // Handle the response, e.g., show a success message
                console.log(response);
            },
            error: function (error) {
                // Handle errors, e.g., show an error message
                console.error(error);
            }
        });

        // Close the modal
        $("#exampleModal").modal("hide");
    }
</script>
</body>

</html>